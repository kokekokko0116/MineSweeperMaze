<html>

<head>
    <title>Minesweeper</title>
    <style>
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
        }

        .modal-content {
            position: relative;
            margin: 15% auto;
            padding: 20px;
            width: 35%;
            height: 35%;
            background-color: #fefefe;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            align-items: center;
            justify-content: center;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 10px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>New Super ãƒã‚¤ãƒ³ã‚¹ã‚¤ãƒ¼ãƒ‘ãƒ¼ï¼ˆæœ¬æ°—ï¼‰</h1>
    <div>
        <p>çˆ†å¼¾ã‚’é¿ã‘ã¦ã‚´ãƒ¼ãƒ«ã‚’ç›®æŒ‡ã™ã‚²ãƒ¼ãƒ ã§ã™ï¼</p>
        <p>ãƒ»ã€ŒSã€ã¯ã‚¹ã‚¿ãƒ¼ãƒˆ(å·¦ä¸Š)ã€ŒGã€ãŒã‚´ãƒ¼ãƒ«ï¼ˆå³ä¸‹ï¼‰ã§ã™</p>
        <p>ãƒ»ãƒ‘ãƒãƒ«ã®æ•°å­—ã¯ãã®å‘¨å›²ï¼˜ãƒã‚¹ã«ã‚ã‚‹çˆ†å¼¾ã®æ•°ã‚’ç¤ºã—ã¦ã¾ã™</p>
        <p>ãƒ»ç™½ãƒ‘ãƒãƒ«ã®ä¸Šä¸‹å·¦å³ã«ç§»å‹•ã§ãã¾ã™</p>
        <p>ãƒ»å³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ãƒ©ãƒƒã‚°ãŒãŸã¦ã‚‰ã‚Œã¾ã™</p>
        <p>ãƒ»ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢ ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®éš›ã«éŸ³ãŒå‡ºã¾ã™ã®ã§ã”æ³¨æ„ãã ã•ã„</p>

    </div>
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <span id="closeModalBtn" class="close">&times;</span>
            <iframe id="screen" width="100%" height="100%" src="" title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen></iframe>
        </div>
    </div>
    <div style="overflow-x: scroll; width: 3000px;">
        <table id="board" style="text-align: center;"></table>
    </div>
    <button onclick="ResetGame()">ãƒªã‚»ãƒƒãƒˆ</button>

    <script>
        // ãƒœãƒ¼ãƒ‰ç”¨ã®é…åˆ—ã‚’ä½œæˆ
        let startY = Math.floor(Math.random() * 20);
        let startX = Math.floor(Math.random() * 20);
        // 80~100ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å€¤ã‚’ç”Ÿæˆ
        let goalY = Math.floor(Math.random() * 20) + 80;
        let goalX = Math.floor(Math.random() * 20) + 80;

        let board = [];
        for (let y = 0; y < 100; y++) {
            board[y] = [];
            for (let x = 0; x < 100; x++) {
                if (y == startY && x == startX) {
                    board[y][x] = 1;
                } else if (y == goalY && x == goalX) {
                    board[y][x] = 2;
                } else {
                    board[y][x] = 0;
                }
            }
        }

        // çˆ†å¼¾ã®ä½ç½®ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºã‚ã‚‹å‡¦ç†
        let mines = [];
        for (let y = 0; y < 100; y++) {
            mines[y] = [];
            for (let x = 0; x < 100; x++) {
                if (board[y][x] == 1) {
                    mines[y][x] = 0;
                }
                else {
                    rand = Math.floor(Math.random() * 100);
                    if (rand < 18) {
                        mines[y][x] = 1;
                    } else {
                        mines[y][x] = 0;
                    }
                }
            }
        }

        // å‘¨ã‚Šã®çˆ†å¼¾ã®æ•°ã‚’æ•°ãˆã‚‹å‡¦ç†
        let minesAround = [];
        for (let y = 0; y < 100; y++) {
            minesAround[y] = [];
            for (let x = 0; x < 100; x++) {
                let counter = 0;
                if (y != 0 && x != 0) counter += mines[y - 1][x - 1]; // å·¦ä¸Š
                if (y != 0) counter += mines[y - 1][x]; // ä¸Š
                if (y != 0 && x != 99) counter += mines[y - 1][x + 1]; // å³ä¸Š
                if (x != 0) counter += mines[y][x - 1]; // å·¦
                if (x != 99) counter += mines[y][x + 1]; // å³
                if (y != 99 && x != 0) counter += mines[y + 1][x - 1]; // å·¦ä¸‹
                if (y != 99) counter += mines[y + 1][x]; // ä¸‹
                if (y != 99 && x != 99) counter += mines[y + 1][x + 1]; // å³ä¸‹
                minesAround[y][x] = counter;
            }
        }

        // ãƒœãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†
        let BoardTable = document.getElementById("board");
        for (let y = 0; y < 100; y++) {
            let tr = document.createElement("tr");
            for (let x = 0; x < 100; x++) {
                let td = document.createElement("td");
                td.style.width = "30px";
                td.style.height = "30px";
                td.style.border = "solid 1px black";
                td.id = y + '-' + x;
                if (board[y][x] == 1) {
                    td.style.backgroundColor = "white";
                    td.innerText = "S";
                } else if (board[y][x] == 2) {
                    td.style.backgroundColor = "white";
                    td.innerText = "G";
                } else {
                    td.style.backgroundColor = "silver";
                    // contextmenuã‚¤ãƒ™ãƒ³ãƒˆ y x ã‚’å–å¾—
                    td.addEventListener('contextmenu', function (e) {
                        e.preventDefault();
                        if (td.innerText == "ğŸ’£") {
                            td.innerText = "";
                        } else {
                            td.innerText = "ğŸ’£";
                        }
                    });
                }
                // ç”Ÿæˆ
                tr.appendChild(td);
            }
            BoardTable.appendChild(tr);
        }
        console.log(mines);

        showCounter(startY, startX);
        function showCounter(y, x) {
            let counter = 0;
            if (y != 0 && x != 0) {
                let td = document.getElementById((y - 1) + '-' + (x - 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y - 1][x - 1];
            }
            if (y != 0) {
                let td = document.getElementById((y - 1) + '-' + (x));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y - 1][x];
                td.onclick = function () {
                    ClickPanel(y - 1, x);
                };
                td.style.cursor = "pointer";
            }
            if (y != 0 && x != 99) {
                let td = document.getElementById((y - 1) + '-' + (x + 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y - 1][x + 1];
            }
            if (x != 0) {
                let td = document.getElementById((y) + '-' + (x - 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y][x - 1];
                td.onclick = function () {
                    ClickPanel(y, x - 1);
                };
                td.style.cursor = "pointer";
            }
            if (x != 99) {
                let td = document.getElementById((y) + '-' + (x + 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y][x + 1];
                td.onclick = function () {
                    ClickPanel(y, x + 1);
                };
                td.style.cursor = "pointer";
            }
            if (y != 99 && x != 0) {
                let td = document.getElementById((y + 1) + '-' + (x - 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y + 1][x - 1];
            }
            if (y != 99) {
                let td = document.getElementById((y + 1) + '-' + (x));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y + 1][x];
                td.onclick = function () {
                    ClickPanel(y + 1, x);
                };
                td.style.cursor = "pointer";
            }
            if (y != 99 && x != 99) {
                let td = document.getElementById((y + 1) + '-' + (x + 1));
                if (td.innerText != "ğŸ’£" && td.innerText != "G") td.innerText = minesAround[y + 1][x + 1];
            }
        }
        function ResetGame() {
            location.reload();
        }
        function ClickPanel(y, x) {
            board[y][x] = 1;
            let td = document.getElementById(y + '-' + x);
            td.style.backgroundColor = "white";
            if (mines[y][x] == 1) {
                td.innerText = "çˆ†";
                document.getElementById('videoModal').style.display = "block";
                let screen = document.getElementById('screen');
                screen.src = "https://www.youtube.com/embed/Sbki9gGbX1o?autoplay=1";
            } else {
                showCounter(y, x);
                if (y == goalY - 1 && x == goalX
                    || y == goalY + 1 && x == goalX
                    || y == goalY && x == goalX - 1
                    || y == goalY && x == goalX + 1) {
                    document.getElementById('videoModal').style.display = "block";
                    let screen = document.getElementById('screen');
                    screen.src = "https://www.youtube.com/embed/I1NElpKjm74?autoplay=1&si=mNK16aS89brWMhED&amp;start=10";
                    // å†ç”Ÿã•ã›ãŸã„å‹•ç”»ã®URLã‚’æŒ‡å®š
                }
            }
        }

        document.getElementById('closeModalBtn').addEventListener('click', function () {
            document.getElementById('videoModal').style.display = "none";
            let screen = document.getElementById('screen');
            screen.src = "";
        });

        // ãƒãƒ¼ã‚­ãƒ³ã‚°æ©Ÿèƒ½


    </script>
</body>

</html>